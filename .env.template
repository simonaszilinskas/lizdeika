# ==============================================================================
# VILNIUS ASSISTANT - ENVIRONMENT CONFIGURATION TEMPLATE
# ==============================================================================
# Copy this file to .env and configure the variables for your deployment
# For Railway: Most variables are automatically configured via Railway UI
# For Docker: Use with docker-compose.yml or docker-compose.prod.yml
# For VM: Configure all variables manually

# ==============================================================================
# BASIC APPLICATION SETTINGS
# ==============================================================================
NODE_ENV=production                                    # Options: development, production
PORT=3002                                             # Application port
FRONTEND_URL=http://localhost:3002                    # Frontend URL (usually same as backend)

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================
# Railway: Automatically configured via Railway PostgreSQL addon
# Docker: Uses docker-compose database configuration
# VM: Configure your PostgreSQL connection
DATABASE_URL="postgresql://username:password@localhost:5432/database_name"
DB_HOST=localhost
DB_PORT=5432
DB_NAME=vilnius_support
DB_USER=vilnius_user
DB_PASSWORD=your_secure_password

# ==============================================================================
# AI PROVIDER CONFIGURATION
# ==============================================================================
# Primary AI provider (required)
AI_PROVIDER=openrouter                                # Options: openrouter, flowise

# OpenRouter Configuration (recommended)
OPENROUTER_API_KEY=sk-or-v1-your-openrouter-api-key
OPENROUTER_MODEL=google/gemini-2.5-flash
SITE_URL=https://your-domain.com                     # Your deployed app URL
SITE_NAME=Vilnius Assistant

# Flowise Configuration (optional fallback)
FLOWISE_URL=https://your-flowise-instance.com
FLOWISE_CHATFLOW_ID=your-chatflow-id
FLOWISE_API_KEY=your-flowise-api-key                 # Optional

# ==============================================================================
# RAG & VECTOR DATABASE CONFIGURATION
# ==============================================================================
# Mistral for embeddings (required for RAG)
MISTRAL_API_KEY=your-mistral-api-key

# ChromaDB Configuration (required for document search)
CHROMA_URL=https://api.trychroma.com
CHROMA_TENANT=your-chroma-tenant-id
CHROMA_DATABASE=your-database-name
CHROMA_API_KEY=your-chroma-api-key

# RAG Settings (configurable via admin interface)
RAG_K=100                                             # Number of documents to retrieve
RAG_SHOW_SOURCES=true                                # Show document sources in responses
ENABLE_QUERY_REPHRASING=true                         # Enable query rephrasing for better search

# ==============================================================================
# AUTHENTICATION & SECURITY
# ==============================================================================
# Generate strong secrets for production!
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_REFRESH_SECRET=your-refresh-token-secret-change-this-in-production
JWT_ACCESS_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# Admin recovery (for password reset)
ADMIN_RECOVERY_KEY=your-admin-recovery-key

# Two-Factor Authentication (2FA)
# Generate a strong 32+ character key for TOTP secret encryption
TOTP_ENCRYPTION_KEY=your-totp-encryption-key-change-this-32-chars-minimum

# ==============================================================================
# WIDGET CUSTOMIZATION
# ==============================================================================
WIDGET_NAME=Vilnius Assistant
WIDGET_PRIMARY_COLOR=#2c5530
WIDGET_ALLOWED_DOMAINS=*                             # Use specific domains in production

# ==============================================================================
# OBSERVABILITY & MONITORING (OPTIONAL)
# ==============================================================================
# Langfuse for AI monitoring and prompt management
LANGFUSE_PUBLIC_KEY=pk-lf-your-public-key-here
LANGFUSE_SECRET_KEY=sk-lf-your-secret-key-here
LANGFUSE_BASE_URL=https://cloud.langfuse.com
LANGFUSE_DEBUG=false

# Logging Configuration
LOG_LEVEL=info                                        # Options: error, warn, info, debug
LOG_TO_FILE=false                                    # Set to true for file logging
LOG_TO_DATABASE=true                                 # Database logging for admin interface
LOG_DIR=./logs

# ==============================================================================
# FILE UPLOAD & STORAGE
# ==============================================================================
MAX_FILE_SIZE=10485760                               # 10MB max file size
UPLOADS_DIR=/var/uploads                             # Upload directory (outside codebase for security)

# ==============================================================================
# DATA RETENTION & CLEANUP
# ==============================================================================
# Archived conversation cleanup (optional)
# If set, enables automatic deletion of archived conversations older than specified days
# Runs daily at 2 AM, processes in batches of 100
# CONVERSATION_RETENTION_DAYS=90                    # Delete archived conversations after 90 days

# ==============================================================================
# EMAIL CONFIGURATION (OPTIONAL)
# ==============================================================================
# For password reset emails (if enabled)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
FROM_EMAIL=noreply@vilnius.lt

# ==============================================================================
# DEPLOYMENT-SPECIFIC OVERRIDES
# ==============================================================================

# Railway Deployment: Most settings auto-configured
# Required: OPENROUTER_API_KEY, MISTRAL_API_KEY, CHROMA_* settings
# DATABASE_URL is auto-configured by Railway PostgreSQL

# Docker Development: All settings used as-is
# Production Docker: Override sensitive values in .env.docker.local

# VM Deployment: Configure all variables manually
# Ensure PostgreSQL is running and DATABASE_URL is correct

# ==============================================================================
# PRODUCTION SECURITY CHECKLIST
# ==============================================================================
# [ ] Change all default passwords and secrets
# [ ] Set WIDGET_ALLOWED_DOMAINS to specific domains
# [ ] Configure HTTPS URLs for SITE_URL
# [ ] Set strong JWT secrets (32+ characters)
# [ ] Configure proper SMTP for email notifications
# [ ] Set up monitoring with Langfuse (optional)
# [ ] Configure log rotation if LOG_TO_FILE=true