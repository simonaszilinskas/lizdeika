{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "DOCKERFILE",
    "dockerfilePath": "Dockerfile"
  },
  "deploy": {
    "startCommand": "node server.js",
    "healthcheckPath": "/health",
    "healthcheckTimeout": 100,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 3
  },
  "environments": {
    "production": {
      "variables": {
        "NODE_ENV": "production",
        "PORT": "${{PORT}}",
        "DATABASE_URL": "${{DATABASE_URL}}",
        "AI_PROVIDER": "openrouter",
        "OPENROUTER_MODEL": "google/gemini-2.5-flash",
        "SITE_URL": "${{RAILWAY_PUBLIC_DOMAIN}}",
        "SITE_NAME": "Vilnius Assistant",
        "WIDGET_NAME": "Vilnius Assistant",
        "WIDGET_PRIMARY_COLOR": "#2c5530",
        "WIDGET_ALLOWED_DOMAINS": "*",
        "RAG_K": "100",
        "RAG_SHOW_SOURCES": "true",
        "ENABLE_QUERY_REPHRASING": "true",
        "JWT_ACCESS_EXPIRES_IN": "15m",
        "JWT_REFRESH_EXPIRES_IN": "7d",
        "LOG_LEVEL": "info",
        "LOG_TO_FILE": "false",
        "LOG_TO_DATABASE": "true",
        "MAX_FILE_SIZE": "10485760",
        "UPLOAD_DIR": "./uploads"
      }
    }
  },
  "services": [
    {
      "name": "vilnius-backend",
      "source": {
        "type": "github",
        "repo": "your-username/vilnius-assistant"
      },
      "variables": {
        "OPENROUTER_API_KEY": {
          "description": "OpenRouter API key for AI responses"
        },
        "MISTRAL_API_KEY": {
          "description": "Mistral API key for embeddings"
        },
        "JWT_SECRET": {
          "description": "JWT secret for authentication (generate a secure random string)"
        },
        "JWT_REFRESH_SECRET": {
          "description": "JWT refresh token secret (generate a secure random string)"
        },
        "ADMIN_RECOVERY_KEY": {
          "description": "Admin recovery key for password reset"
        },
        "CHROMA_URL": {
          "description": "ChromaDB API URL (e.g., https://api.trychroma.com)"
        },
        "CHROMA_TENANT": {
          "description": "ChromaDB tenant ID"
        },
        "CHROMA_DATABASE": {
          "description": "ChromaDB database name"
        },
        "CHROMA_AUTH_TOKEN": {
          "description": "ChromaDB authentication token"
        },
        "LANGFUSE_PUBLIC_KEY": {
          "description": "Langfuse public key (optional, for AI monitoring)"
        },
        "LANGFUSE_SECRET_KEY": {
          "description": "Langfuse secret key (optional, for AI monitoring)"
        },
        "LANGFUSE_BASE_URL": {
          "description": "Langfuse base URL (optional, defaults to https://cloud.langfuse.com)"
        }
      }
    }
  ],
  "plugins": [
    {
      "name": "postgresql",
      "config": {
        "version": "15"
      }
    }
  ]
}